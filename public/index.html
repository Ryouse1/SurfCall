<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>プロキシダウンロード</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input { width: 400px; }
    button { margin-left: 5px; }
    .url-item { margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>URL入力で即ダウンロード</h1>

  <h2>単一ファイル</h2>
  <input type="text" id="single-url" placeholder="ファイルのURL">
  <button onclick="downloadSingle()">ダウンロード</button>

  <h2>複数ファイル（リスト形式）</h2>
  <div id="url-list">
    <div class="url-item">
      <input type="text" placeholder="ファイルURL">
      <button onclick="removeRow(this)">×</button>
    </div>
  </div>
  <button onclick="addRow()">＋追加</button>
  <button onclick="downloadMultiple()">一括ダウンロード（ZIP）</button>

  <script>
    function downloadSingle() {
      const url = document.getElementById('single-url').value;
      if (!url) return alert("URLを入力してください");
      window.location.href = `/fetch?url=${encodeURIComponent(url)}`;
    }

    function addRow() {
      const div = document.createElement('div');
      div.className = 'url-item';
      div.innerHTML = '<input type="text" placeholder="ファイルURL"><button onclick="removeRow(this)">×</button>';
      document.getElementById('url-list').appendChild(div);
    }

    function removeRow(btn) {
      btn.parentElement.remove();
    }

    function downloadMultiple() {
      const inputs = document.querySelectorAll('#url-list input');
      const urls = Array.from(inputs).map(input => input.value).filter(u => u);
      if (!urls.length) return alert("URLを入力してください");
      window.location.href = `/fetch-multiple?urls=${encodeURIComponent(urls.join(','))}`;
    }
  </script>
</body>
</html>
